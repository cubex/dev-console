<link href="../../polymer/polymer.html" rel="import">
<link href="../../cube-websocket/cube-websocket.html" rel="import">
<link href="../../cube-action/cube-action.html" rel="import">
<link href="../../app-route/app-route.html" rel="import">
<link href="../../app-route/app-location.html" rel="import">
<link href="../../paper-tooltip/paper-tooltip.html" rel="import">

<dom-module id="cubex-pinned-apps">
  <template>
    <style>
      :host {
        display: flex;
        align-items: center;
      }

      a {
        display: inline-flex;
        @apply(--primary-700-text-secondary);
      }

      a:hover {
        @apply(--primary-700-text);
      }

      paper-tooltip {
        margin-top: 35px;
        pointer-events: none;
        border-radius: 5px;

        --paper-tooltip-text-color: var(--primary-800-text-color);
        --paper-tooltip-background: var(--primary-800-color);
        --paper-tooltip: {
          font-size: 12px;
          border: 1px solid var(--primary-400-color);
          @apply --shadow-elevation-4dp;
        }
      }
    </style>
    <app-location route="{{route}}"></app-location>
    <app-route route="[[route]]" pattern="/:project" data="{{routeData}}"></app-route>
    <cube-websocket auto vendor="cubex" app="pinnedapps" on-subscribe="_pinnedSub"
                    on-message="_pinnedMsg"></cube-websocket>
    <template is="dom-repeat" items="[[pinnedApps]]">
      <a href="/[[routeData.project]]/[[item.GlobalAppID]]">
        <cube-action id="pinned-[[item.ID]]" icon="[[item.Icon]]"></cube-action>
      </a>
      <paper-tooltip for="pinned-[[item.ID]]" position="center" animation-delay="100"><strong>[[item.Name]]</strong>
      </paper-tooltip>
    </template>
  </template>
  <script>
    Polymer(
      {
        is:         'cubex-pinned-apps',
        properties: {
          pinnedApps: {type: Array, value: function () {return [];}}
        },
        _pinnedSub: function (e, msg)
                    {
                      this.set('pinnedApps', JSON.parse(msg));
                    },
        _pinnedMsg: function (e, msg)
                    {
                      this.set('pinnedApps', msg.payload);
                    }
      }
    );
  </script>
</dom-module>
